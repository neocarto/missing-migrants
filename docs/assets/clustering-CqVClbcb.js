import{clustersDbscan as h}from"./index-B2OyUy_M.js";import{f as v,a as d,m as g,s as w}from"./sum-CCBp8Gji.js";function F(r,n,s){if(!r)throw new Error("geojson is required");if(r.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");for(var a=C(r,n),t=Object.keys(a),o=0;o<t.length;o++){for(var c=t[o],i=a[c],p=[],e=0;e<i.length;e++)p.push(r.features[i[e]]);s(v(p),c,o)}}function O(r,n,s,a){var t=a;return F(r,n,function(o,c,i){i===0&&a===void 0?t=o:t=s(t,o,c,i)}),t}function C(r,n){var s={};return d(r,function(a,t){var o=a.properties||{};if(Object.prototype.hasOwnProperty.call(o,String(n))){var c=o[n];Object.prototype.hasOwnProperty.call(s,c)?s[c].push(t):s[c]=[t]}}),s}function j(r,n=100,s="All"){let a=h(r,n),t={type:"FeatureCollection",features:a.features.filter(e=>e.properties.dbscan=="core")},o=a.features.filter(e=>e.properties.dbscan=="noise").map(e=>({type:"Feature",properties:{type:s,dbscan:"noise",count:1,nb:e.properties.nb},geometry:{type:"Point",coordinates:m(e.geometry.coordinates)}}));return{type:"FeatureCollection",features:O(t,"cluster",function(e,u){return e.push(u),e},[]).map(e=>{let u=e.features,f=u.map(l=>l.properties.nb),y=f.indexOf(g(f)),b=u[y].geometry;return{type:"Feature",properties:{type:s,dbscan:"core",count:u.length,nb:w(u.map(l=>l.properties.nb))},geometry:{type:"Point",coordinates:m(b.coordinates)}}}).concat(o)}}function m(r,n=.2){return[r[0]+(Math.random()-.5)*2*n,r[1]+(Math.random()-.5)*2*n]}export{j as clustering};
