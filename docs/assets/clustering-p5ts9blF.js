import{clustersDbscan as h}from"./index-Cfoo9kR3.js";import{f as v,m as d,s as g}from"./sum-Bk_2uiXi.js";import{f as w}from"./index-DWCRgfoN.js";function F(r,n,s){if(!r)throw new Error("geojson is required");if(r.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");for(var a=C(r,n),t=Object.keys(a),o=0;o<t.length;o++){for(var c=t[o],i=a[c],u=[],e=0;e<i.length;e++)u.push(r.features[i[e]]);s(w(u),c,o)}}function O(r,n,s,a){var t=a;return F(r,n,function(o,c,i){i===0&&a===void 0?t=o:t=s(t,o,c,i)}),t}function C(r,n){var s={};return v(r,function(a,t){var o=a.properties||{};if(Object.prototype.hasOwnProperty.call(o,String(n))){var c=o[n];Object.prototype.hasOwnProperty.call(s,c)?s[c].push(t):s[c]=[t]}}),s}function z(r,n=100,s="All"){let a=h(r,n),t={type:"FeatureCollection",features:a.features.filter(e=>e.properties.dbscan=="core")},o=a.features.filter(e=>e.properties.dbscan=="noise").map(e=>({type:"Feature",properties:{type:s,dbscan:"noise",count:1,nb:e.properties.nb},geometry:{type:"Point",coordinates:m(e.geometry.coordinates)}}));return{type:"FeatureCollection",features:O(t,"cluster",function(e,p){return e.push(p),e},[]).map(e=>{let p=e.features,f=p.map(l=>l.properties.nb),y=f.indexOf(d(f)),b=p[y].geometry;return{type:"Feature",properties:{type:s,dbscan:"core",count:p.length,nb:g(p.map(l=>l.properties.nb))},geometry:{type:"Point",coordinates:m(b.coordinates)}}}).concat(o)}}function m(r,n=.2){return[r[0]+(Math.random()-.5)*2*n,r[1]+(Math.random()-.5)*2*n]}export{z as clustering};
